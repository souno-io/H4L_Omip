"use strict";(self["webpackChunkdrgs"]=self["webpackChunkdrgs"]||[]).push([[165],{4024:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var l=a(6252),i=a(3577);const d={class:"custom-tree-node"},o={class:"label"},n={class:"code"},r={class:"left-panel"},s={class:"block"},c={class:"right-panel"};function p(e,t,a,p,u,h){const m=(0,l.up)("el-input"),g=(0,l.up)("el-header"),w=(0,l.up)("el-tree"),b=(0,l.up)("el-main"),_=(0,l.up)("el-container"),f=(0,l.up)("el-aside"),W=(0,l.up)("el-date-picker"),k=(0,l.up)("el-button"),y=(0,l.up)("el-table-column"),D=(0,l.up)("scTable"),x=(0,l.up)("dic-dialog"),C=(0,l.up)("list-dialog"),S=(0,l.Q2)("loading");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l.wy)(((0,l.wg)(),(0,l.j4)(f,{width:"300px"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(m,{placeholder:"输入关键字进行过滤",modelValue:u.dicFilterText,"onUpdate:modelValue":t[0]||(t[0]=e=>u.dicFilterText=e),clearable:""},null,8,["modelValue"])])),_:1}),(0,l.Wm)(b,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{ref:"dic",class:"menu filter-tree","node-key":"id",data:u.dicList,props:u.dicProps,"highlight-current":!0,"expand-on-click-node":!1,"filter-node-method":h.dicFilterNode,onNodeClick:h.dicClick},{default:(0,l.w5)((({node:e,data:t})=>[(0,l._)("span",d,[(0,l._)("span",o,(0,i.zw)(e.label),1),(0,l._)("span",n,(0,i.zw)(t.code),1)])])),_:1},8,["data","props","filter-node-method","onNodeClick"])])),_:1})])),_:1})])),_:1})),[[S,u.showDicloading]]),(0,l.Wm)(_,{class:"is-vertical"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l._)("div",r,[(0,l._)("div",s,[(0,l.Wm)(W,{modelValue:u.data_range,"onUpdate:modelValue":t[1]||(t[1]=e=>u.data_range=e),format:"YYYY年MM月DD日","value-format":"YYYY-MM-DD",type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),(0,l.Uk)("     "),(0,l.Wm)(k,{type:"primary",icon:"el-icon-search",onClick:t[2]||(t[2]=e=>this.$refs.table.reload({id:u.item.id,start_date:u.data_range[0],end_date:u.data_range[1]}))})]),(0,l._)("div",c,[(0,l.Wm)(k,{type:"primary",icon:"el-icon-printer",onClick:t[3]||(t[3]=e=>h.print_table())}),(0,l.Wm)(k,{type:"primary",icon:"el-icon-download",onClick:t[4]||(t[4]=e=>h.exportExcelHandle("exportTable"))})])])),_:1}),(0,l.Wm)(b,{class:"nopadding"},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{ref:"table",apiObj:u.listApi,"row-key":"id",params:u.listApiParams,id:"exportTable",onSelectionChange:e.selectionChange,hidePagination:""},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{label:"序号",align:"center"},{default:(0,l.w5)((e=>[(0,l.Uk)((0,i.zw)(e.$index+1),1)])),_:1}),(0,l.Wm)(y,{label:"住院号码",prop:"住院号码",width:"85"}),(0,l.Wm)(y,{label:"姓名",prop:"姓名",width:"80"}),(0,l.Wm)(y,{label:"身份证号",prop:"身份证号",width:"155"}),(0,l.Wm)(y,{label:"年龄",prop:"年龄",width:"60"}),(0,l.Wm)(y,{label:"入院科别",prop:"入院科别",width:"150"}),(0,l.Wm)(y,{label:"出院主要诊断编码",prop:"出院主要诊断编码",width:"100"}),(0,l.Wm)(y,{label:"出院主要诊断名称",prop:"出院主要诊断名称",width:"150"}),(0,l.Wm)(y,{label:"出院诊断疾病编码1",prop:"出院诊断疾病编码1",width:"100"}),(0,l.Wm)(y,{label:"出院诊断其他诊断1",prop:"出院诊断其他诊断1",width:"150"}),(0,l.Wm)(y,{label:"主要手术操作编码",prop:"主要手术操作编码",width:"100"}),(0,l.Wm)(y,{label:"主要手术操作名称",prop:"主要手术操作名称",width:"150"}),(0,l.Wm)(y,{label:"住院天数",prop:"住院天数",width:"60"}),(0,l.Wm)(y,{label:"总费用",prop:"总费用",width:"100"}),(0,l.Wm)(y,{label:"离院方式",prop:"离院方式",width:"60"})])),_:1},8,["apiObj","params","onSelectionChange"])])),_:1})])),_:1})])),_:1}),u.dialog.dic?((0,l.wg)(),(0,l.j4)(x,{key:0,ref:"dicDialog",onSuccess:e.handleDicSuccess,onClosed:t[5]||(t[5]=e=>u.dialog.dic=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0),u.dialog.list?((0,l.wg)(),(0,l.j4)(C,{key:1,ref:"listDialog",onSuccess:e.handleListSuccess,onClosed:t[6]||(t[6]=e=>u.dialog.list=!1)},null,8,["onSuccess"])):(0,l.kq)("",!0)],64)}var u=a(2423),h=a(2247),m=a(1469),g=a(3162),w=a.n(g),b=a(4105),_={exportExcel(e,t,a,l){let i,d=document.querySelector(".el-table__fixed-right");d?(i=b.P6.table_to_book(document.querySelector("#"+e).removeChild(d),{raw:l}),document.querySelector("#"+e).appendChild(d)):i=b.P6.table_to_book(document.querySelector("#"+e),{raw:l});let o=b.cW(i,{bookType:"xlsx",bookSST:!0,type:"array"});try{w().saveAs(new Blob([o],{type:"application/octet-stream"}),t+a)}catch(n){"undefined"!==typeof console&&console.log(n,o)}return o}},f={name:"drgs",components:{dicDialog:u["default"],listDialog:h["default"]},data(){return{item:{id:"",label:""},dialog:{dic:!1,info:!1},data_range:"",showDicloading:!0,dicList:[],dicFilterText:"",dicProps:{label:"label"},listApi:null,listApiParams:{},selection:[]}},watch:{dicFilterText(e){this.$refs.dic.filter(e)}},mounted(){this.data_range=[this.getFirstDay(),this.getLastDay()],this.getDic()},methods:{print_table(){(0,m.Z)(this.$refs["table"])},exportExcelHandle(e){_.exportExcel(e,this.item.label+"("+this.data_range[0]+"_"+this.data_range[1]+")",".xlsx",!0)},getFirstDay(){const e=(new Date).getFullYear();let t=(new Date).getMonth()+1;const a="01";return t=t<10?"0"+t:t,[e,t,a].join("-")},getLastDay(){const e=(new Date).getFullYear();let t=(new Date).getMonth()+1,a=new Date(e,t,0).getDate();return t=t<10?"0"+t:t,a=a<10?"0"+a:a,[e,t,a].join("-")},async getDic(){var e=await this.$API.drgs.list.get({pageSize:100});this.showDicloading=!1,this.dicList=e.data.rows;var t=this.dicList[0];t&&(this.$nextTick((()=>{this.$refs.dic.setCurrentKey(t.id)})),this.listApiParams={id:t.id,start_date:this.data_range[0],end_date:this.data_range[1]},this.item.id=t.id,this.item.label=t.label,this.listApi=this.$API.drgs.details)},dicFilterNode(e,t){if(!e)return!0;var a=t.label+t.code;return-1!==a.indexOf(e)},dicClick(e){this.item.id=e.id,this.item.label=e.label,this.$refs.table.reload({id:e.id,start_date:this.data_range[0],end_date:this.data_range[1]})}}},W=a(3744);const k=(0,W.Z)(f,[["render",p],["__scopeId","data-v-2c741af4"]]);var y=k}}]);